{% load staticfiles %}
<html>
<head>
    <title>Xun V</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'leaflet/leaflet.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
</head>
<body>
{% include "includes/nav.html" %}

<main>
    <div class="container">
    {% block content %}

    {% endblock %}
    </div>
</main>
</body>
<script src="{% static 'js/jquery-2.2.2.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'leaflet/leaflet.js' %}"></script>
<script src="{% static 'leaflet/plugins/leaflet.ajax.min.js' %}"></script>
<script src="{% static 'js/app.js' %}"></script>
<script>
var map = L.map('mapid').setView([35.73, 109.59], 4);

L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
    maxZoom: 6,
    id: '{{ MAPBOX_ID }}',
    accessToken: '{{ MAPBOX_TOKEN }}'
}).addTo(map);

L.geoJson(ChinaGeo, {
  onEachFeature: function(feature, layer) {
    var label = L.marker(layer.getBounds().getCenter(), {
      icon: L.divIcon({
        className: 'label',
        html: feature.properties.name
      })
    }).addTo(map);
    layer.on('click', function (e) {
      map.setView([feature.properties.cp[1], feature.properties.cp[0]], 7, {animation: true});
      var provinceID = feature.properties.id;
      var geojsonLayer = L.geoJson.ajax("/static/data/province/" + provinceID + ".json");
      geojsonLayer.refresh();
    });
  },
    style: {
        "color": "#ff7800",
        "weight": 2,
        "opacity": 0.2
    }
}).addTo(map);
</script>
</html>
